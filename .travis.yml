dist: trusty
language: java
jdk:
- openjdk12
cache:
  directories:
  - "$HOME/.m2"
before_script:
- export DISPLAY=:99.0
- sh -e /etc/init.d/xvfb start
- sleep 3
before_install:
- openssl aes-256-cbc -K $encrypted_25a884814f46_key -iv $encrypted_25a884814f46_iv
  -in deployment/signingkey.asc.enc -out deployment/signingkey.asc -d
- cp .travis.settings.xml $HOME/.m2/settings.xml
- "/sbin/start-stop-daemon --start --quiet --pidfile /tmp/custom_xvfb_99.pid --make-pidfile
  --background --exec /usr/bin/Xvfb -- :99 -ac -screen 0 1280x1024x16"
- google-chrome-stable --remote-debugging-port=9222 http://localhost &
- chmod ugo+x scripts/publish-javadocs-to-github-pages.sh
- chmod ugo+x scripts/get-bank-holiday-data-source-and-store-in-resources.sh
addons:
  firefox: latest
install:
- mvn clean install -Dmaven.javadoc.skip=true -B -V
after_success:
- gpg2 --keyring=$TRAVIS_BUILD_DIR/pubring.gpg --no-default-keyring --import deployment/signingkey.asc
- gpg2 --allow-secret-key-import --keyring=$TRAVIS_BUILD_DIR/secring.gpg --no-default-keyring
  --import deployment/signingkey.asc
- mvn clean deploy -Dgpg.executable=gpg2 -Dgpg.keyname=5F84CD1775351968CABF0B0D779D2423E1D24D89
  -Dgpg.passphrase=$GPG_PASSPHRASE -Dgpg.publicKeyring=$TRAVIS_BUILD_DIR/pubring.gpg -Dgpg.secretKeyring=$TRAVIS_BUILD_DIR/secring.gpg
deploy:
- provider: script
  script: mvn test com.gavinmogan:codacy-maven-plugin:coverage -DcoverageReportFile=target/site/jacoco/jacoco.xml
    -DprojectToken=$CODACY_PROJECT_TOKEN -DapiToken=$CODACY_API_TOKEN
  on:
    branch: master
- provider: script
  script: bash scripts/publish-javadocs-to-github-pages.sh
  on:
    tags: true
- provider: script
  script:
    - mvn release:prepare
    - mvn release:perform
  on:
    tags: true
env:
  global:
  - secure: cM73yz9Rj/wlGB+iIKnerkMhOH6dwMw97e0eNN8qIaA3x6Wp9JGwLOkctQTkOB3HgTsaO6I6/eIWylb8bzdQhu08zZvEmAGr8MXSRNtQm5l2zdx4uovwp8VAr2DBFmk1uyOXErwqsTo7ofSkjDcjNN57XR28frFYAuYAqa0+M9hMC4PWkawI22k9LgLA8LtR0Yzkto8eH1bw74YPMXhjjBZ6b/BTUqAOkwWbGujUmLtT7VeEMxKGJwgyoCw2+UKRtdAU+/E0LCAU2DuxYTtn00Om7GDV5eXZu58s+mRLMRG2038U/Bam4dTy6ZNrKjHlR3l3yyhSKKarG6st7cHvqYI2eaHi6L205o9RI4jqihIfPhxX2AtYGimSrQzHEvrc2hXqM4oqqT8xM6BCRIGfBmImUikBh3d+MubFXlne/mEPyq+csDer3Waz0sD2OrxtPjIKUGAltH61g/Wy54L4IVd5KzhX65lddYRMTyALyiTzWmYDmfD/IvhPOurjz4GU4FiNbBxiihKgc4FPFXWPRJVMu5Hb20b4g4RungBFtyBxw24VzwOaMOz7d9K8bR2NMydT/QaaLG3OQvTkO/2xQN00ddy1KJ7O7S1MGRJFq5ZEUjvUDAeRAANY86GVMk4lKh2U6EJo21hhADGWqqAuCo6fhyrVprExEAAk1OMc6A8=
  - secure: I4fr21xrDzmh22zAD1xmEYlo/KOZmFz1khuUb/QfMxARLHn6+voYQdULOHSBZzESZSKsKhPhGPUWLBHcXkKLGepHqPGP8iybu0FIiDjCTyuQokG6d/O8A4V8Cp6y1pn/mrDGQUnDYGnVdpxRePyA/IO4/kxHdMJcP+Ff8HrvabXPuwia0UsSnCKSHaGvjNY0nsY/QhohYcZCDfeDctP9XNl3+EOOCLyVQzi6PjWK425Yn73rRzcheEGUAvxTKa2Vw2H6rxUjj6CqsyX87r7bo9fiEZZexHL7qCXe7MeNLpNYYQH26ThWWjc4YgRxcDXdDKJctj8CPesGm4sKd0/jzPND/UYHe0mhum193L2EEIkHR9viUG+YrSddAaAes/g6tKAg8M+qD3auTTJ2XfC4zI+T1OcDct3WlQBow9u2OfhSpAnLBg3bUN2QzMtdZ2ZQNVieNI1tIYRnnwOV/hy0WYS7VOu0vWNP3XXNByWVoiweQhwvpRELjjMxgLWJ8TQhPXJ1qISLws2YvHbffDFG4ysGx4LsccfevTSt5EA8zuz6kRUzcQspWnmdSgQ/gX0Ruzi/S1wHwhFr+j7ulpTM5diWLb75f5u33UGvCF312EQpuKCQ9HNXBN/k5IZnUN1BoiH53/xdAfnqwKLcNbmRR47eq6GuPE0p3Vuz5GMG8ZU=
  - secure: EPf05A7CuUj6gtIIg722Pq30P+huDmOvz7g2KVfi1YWwQpvryT6cH4KJky7MLegKXJ3kn8UwNCW8vU76VZcUiIYPg0WLsxXOu6gDMsDfnm2XX69uyIJTNw6Q2pfd8dKmJomZFRoIs5AD9hjU0iukVRL/Wlq3eU4NLFfToPLsv5NbckW1IjPYCvlVTUviyhACr+veDX8wIADEtQoqD4KxUnYqS0IZjFJwWGngIYe+YX4lW+qU3IIsuHxOCivkESkMQci2/eL8/gNqKbF8EFza2rzaDuJdaBj2etTxH6UoAJ0P9ZzsY0Kku7rVDSjqg5zZ5mo/OsQLCPkuXf/MKCUp4oJ8z2wxcEXe5YIO9G8S3sNaLIAQNLTwjfGFBP9YVWhZng1OBdLvh8+/r3kuPlilEu7H4M8iQ5zl9iV4SiguLOzcbV0hDm6F2UnUhvUwy8PJoDKVXJjW7PbYMBwGKnOu7QFG7LrLVCM7zORHfg+iu317yFdZLF+Jn+mBu5WGY+Jgr3rJnkgC7s5mQ+KKrWeFc/fZirykC8RbCkuss5KeQvkIiLtExvHP/1jPld/mhM2ItfCR6REVwHCN7zBYK56S8fa+oxT4ozc2p6Ked/F+QrrS0LekWcS0QnWYD5/Bp0iJVjL1HMv0vOKJimbmSf2athuFGA1gkTpBPKG7opSZf58=
